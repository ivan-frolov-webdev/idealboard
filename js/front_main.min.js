function hideDelImgPreview(e,i,a){e.replaceWith(e.clone(!0)),i.attr("src",""),a.slideUp()}jQuery(document).ready(function(e){var i="/wp-admin/admin-ajax.php";if(e("#ib_price_index").on("change",function(i){i.preventDefault(),i.stopPropagation;var a=e(this),n=a.val();e("#currency_id").val(n)}),e("#profile_form").validate({debug:!1,rules:{ib_user_name:{required:!0,minlength:3,maxlength:30},ib_user_phone:{required:!0,minlength:5,maxlength:20}},messages:{ib_user_name:{required:"Обязательное поле, заполните пожалуйста!",minlength:"Минимальная длинна текста - 3 символов",maxlength:"Максимальная длинна текста - 30 символов"},ib_user_phone:{required:"Обязательное поле, заполните пожалуйста!",minlength:"Минимальная длинна текста - 5 символов",maxlength:"Максимальная длинна текста - 20 символов"}}}),e("#adv_form").validate({debug:!1,rules:{ib_title:{required:!0,minlength:5,maxlength:75},adv_text:{required:!0,minlength:50,maxlength:5e3},ib_name:{required:!0,minlength:3,maxlength:30},ib_phone:{required:!0,minlength:5,maxlength:20},ib_email:{required:!0,email:!0}},messages:{ib_title:{required:"Обязательное поле, заполните пожалуйста!",minlength:"Минимальная длинна текста - 5 символов",maxlength:"Максимальная длинна текста - 75 символов"},adv_text:{required:"Обязательное поле, заполните пожалуйста!",minlength:"Минимальная длинна текста - 50 символов",maxlength:"Максимальная длинна текста - 5000 символов"},ib_name:{required:"Обязательное поле, заполните пожалуйста!",minlength:"Минимальная длинна текста - 3 символов",maxlength:"Максимальная длинна текста - 30 символов"},ib_phone:{required:"Обязательное поле, заполните пожалуйста!",minlength:"Минимальная длинна текста - 5 символов",maxlength:"Максимальная длинна текста - 20 символов"},ib_email:{required:"Обязательное поле, заполните пожалуйста!",email:"Введите правильный e-mail"}},invalidHandler:function(e,i){i.numberOfInvalids()},submitHandler:function(e){}}),e("#submit_advert_front").on("click",function(a){if(a.preventDefault(),a.stopPropagation(),e(".alert").removeClass("alert-success").removeClass("alert-danger"),e("#adv_form").valid()){var n=new FormData;n.append("action","save_adverts"),n.append("user_id",e("#user_id").val()),n.append("category",e("#category").val()),n.append("ib_regions",e("#ib_regions").val()),n.append("ib_title",e("#ib_title").val()),n.append("adv_text",e("#adv_text").val()),n.append("ib_price",e("#ib_price").val()),n.append("currency_id",e("#currency_id").val()),n.append("photo",e("input[type=file]")[0].files[0]),n.append("ib_name",e("#ib_name").val()),n.append("ib_phone",e("#ib_phone").val()),n.append("ib_email",e("#ib_email").val()),e.ajax({type:"POST",url:i,data:n,dataType:"json",contentType:!1,processData:!1,success:function(i){e("#submit_profile_front").prop("disabled",!0),"success"==i?(e(".alert").addClass("alert-success").text("Сохранено!").fadeIn(),setTimeout(function(){window.location.reload()},3e3)):"error"!=i&&i||e(".alert").addClass("alert-danger").text("Ошибка! Объявление не сохранено...").fadeIn()},error:function(e,i,a){}})}}),e("#submit_profile_front").prop("disabled",!0),e("#ib_user_name, #ib_user_phone").on("keyup",function(i){""!=e(this).val()&&e("#submit_profile_front").prop("disabled",!1)}),e("#submit_profile_front").on("click",function(a){if(a.preventDefault(),a.stopPropagation(),e("#profile_form").valid()){var n=e("#ib_user_name").val(),r=e("#ib_user_phone").val(),t=e("#user_id").val(),l={action:"save_profile",ib_name:n,ib_phone:r,user_id:t};e.ajax({type:"POST",url:i,dataType:"json",data:l,beforeSend:function(e){e&&e.overrideMimeType&&e.overrideMimeType("application/json;charset=UTF-8")},success:function(i){e("#submit_profile_front").prop("disabled",!0),"success"==i?e(".alert").addClass("alert-success").text("Сохранено!").fadeIn():"error"==i&&e(".alert").addClass("alert-danger").text("Ошибка! Объявление не сохранено...").fadeIn(),setTimeout(function(){window.location.reload()},3e3)},error:function(e,i,a){}})}}),e("#ib_title").length||e("#ib_user_name").length){var a=e("#ib_title, #ib_user_name").outerHeight();e("select").css("height",a)}e("#ib_adv_photo").on("change",function(){var i=e(this),a=i[0],n=new RegExp("([a-zа-яA-ZА-Я0-9s_\\.-:])+(.jpg|.png|.gif)$"),r=e("#ib_adv_photo"),t=e("#image_preview_img"),l=e("#image_preview");if(!n.test(a.value.toLowerCase()))return alert("Допустимы изображения в формате: jpg, png, gif"),hideDelImgPreview(r,t,l),!1;if("undefined"==typeof a.files)return alert("Упс, какая-то ошибка - перезагрузите страницу и попробуйте еще раз..."),hideDelImgPreview(r,t,l),!1;var o=new FileReader;o.readAsDataURL(a.files[0]),o.onload=function(e){var i=new Image;i.src=e.target.result,i.onload=function(){var e=(this.height,this.width);return 100>e?(alert("Минимальная ширина изображения 100px"),hideDelImgPreview(r,t,l),!1):e>1200?(alert("Максимальная ширина изображения 1200px"),hideDelImgPreview(r,t,l),!1):(t.attr("src",i.src),l.slideDown(),!0)}}}),e("#remove_from_preview").on("click",function(i){i.preventDefault(),i.stopPropagation();var a=e("#ib_adv_photo"),n=e("#image_preview_img"),r=e("#image_preview");hideDelImgPreview(a,n,r)})});